<odoo>
    <data>

        <!-- Inherited purchase.order form view -->
        <record id="inherit_purchase_order_form" model="ir.ui.view">
            <field name="name">inherit.purchase.order.form</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//group[2]" position="inside">
                    <field name="show_measure" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='order_line']/tree/field[@name='product_qty']" position="before">
                    <field name="length" optinal="show"
                           attrs="{'column_invisible': [('parent.show_measure', '=', False)]}"/>
                    <field name="width" optinal="show"
                           attrs="{'column_invisible': [('parent.show_measure', '=', False)]}"/>
                    <field name="height" optinal="show"
                           attrs="{'column_invisible': [('parent.show_measure', '=', False)]}"/>
                    <field name="unit_qty" attrs="{'column_invisible': [('parent.show_measure', '=', False)]}"/>
                </xpath>
            </field>
        </record>


        <!-- Inherited stock.picking form view -->
        <record id="inherit_view_picking_form" model="ir.ui.view">
            <field name="name">inherit.stock.picking.form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml">
                <xpath expr="//group[2]" position="inside">
                    <field name="show_measure" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='move_ids_without_package']/tree/field[@name='product_uom_qty']"
                       position="before">
                    <field name="length" attrs="{'column_invisible': [('parent.show_measure', '=', False)]}"/>
                    <field name="width" attrs="{'column_invisible': [('parent.show_measure', '=', False)]}"/>
                    <field name="height" attrs="{'column_invisible': [('parent.show_measure', '=', False)]}"/>
                </xpath>
            </field>
        </record>

        <!-- Inherited stock.production.lot form view -->
        <record id="inherit_view_stock_production_lot_form" model="ir.ui.view">
            <field name="name">inherit.stock.production.lot.form</field>
            <field name="model">stock.production.lot</field>
            <field name="inherit_id" ref="stock.view_production_lot_form"/>
            <field name="arch" type="xml">
                <xpath expr="//group[@name='main_group']" position="replace">
                    <group name="main_group">
                        <group>
                            <field name="product_id"
                                   context="{'default_detailed_type': 'product', 'default_tracking': 'lot'}"
                                   readonly="context.get('set_product_readonly', False)" force_save="1"
                                   help="Product this lot/serial number contains. You cannot change it anymore if it has already been moved."/>
                            <label for="product_qty" attrs="{'invisible': [('display_complete', '=', False)]}"/>
                            <div class="o_row" attrs="{'invisible': [('display_complete', '=', False)]}">
                                <field name="product_qty"/>
                                <field name="product_uom_id" groups="uom.group_uom"/>
                            </div>
                            <field name="product_qty_units"/>
                            <field name="ref"/>
                            <field name="company_id" groups="base.group_multi_company"/>
                        </group>

                        <group>
                            <field name="show_measure" invisible="1"/>
                            <field name="length" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                            <field name="width" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                            <field name="height" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                        </group>
                        <group/>
                    </group>
                </xpath>
            </field>
        </record>

        <!-- Inherited stock.production.lot tree view -->
        <record id="inherit_view_production_lot_tree" model="ir.ui.view">
            <field name="name">inherit.stock.production.lot.tree</field>
            <field name="model">stock.production.lot</field>
            <field name="inherit_id" ref="stock.view_production_lot_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='product_id']" position="after">
                    <field name="length" optional="show"/>
                    <field name="width" optional="show"/>
                    <field name="height" optional="show"/>
                    <field name="product_qty" optional="show"/>
                    <field name="product_uom_id" groups="uom.group_uom"/>
                    <field name="product_qty_units" optional="show"/>
                </xpath>
            </field>
        </record>

        <!-- Inherited stock.move.line tree view -->
        <record id="inherit_view_stock_move_line_operation_tree" model="ir.ui.view">
            <field name="name">inherit.stock.move.line.operations.tree</field>
            <field name="model">stock.move.line</field>
            <field name="inherit_id" ref="stock.view_stock_move_line_operation_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='product_uom_qty']" position="before">
                    <field name="show_measure" invisible="1"/>
                    <field name="length" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                    <field name="width" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                    <field name="height" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                    <field name="unit_qty" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                </xpath>
                <xpath expr="//field[@name='lot_id']" position="attributes">
                    <attribute name="context">
                        {'default_product_id': product_id,'default_length':length ,
                        'default_company_id': company_id,
                        'active_picking_id': picking_id,
                        'default_width':width,
                        'default_height':height,
                        }
                    </attribute>
                </xpath>

            </field>
        </record>

        <!-- Inherited mrp.production form view -->
        <record id="inherit_mrp_production_form_view" model="ir.ui.view">
            <field name="name">inherit.mrp.production.form</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
            <field name="arch" type="xml">
                <field name="product_id" position="after">
                    <field name="production_mechanism" invisible="1"/>
                    <field name="unit_qty" force_save="1"
                           attrs="{'readonly': ['|',('state', '!=', 'draft'),('production_mechanism','=','multiple_lot')]}"/>
                </field>
                <field name="product_qty" position="attributes">
                    <attribute name="force_save">1</attribute>
                    <!-- <attribute name="readonly">[('production_mechanism','=','multiple_lot')]</attribute> -->
                    <attribute name="attrs">{'readonly':['|',('state', '!=', 'draft'),('production_mechanism', '=', 'multiple_lot')]}</attribute>
                </field>
                <xpath expr="//group/group[1]" position="inside">
                    <field name="show_measure" invisible="1"/>
                    <field name="length" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                    <field name="width" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                    <field name="height" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                    <field name="ml" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                    <field name="m2" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                    <field name="m3" attrs="{'invisible': [('show_measure', '=', False)]}"/>
                </xpath>
            </field>
        </record>

        <!-- Inherited stock.move.line form view -->
        <record id="inherit_view_company_form" model="ir.ui.view">
            <field name="name">inherit.res.company.form</field>
            <field name="model">res.company</field>
            <field name="inherit_id" ref="base.view_company_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='favicon']" position="after">
                    <field name="show_measure"/>
                </xpath>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_decimal_precision_form_inherit">
                <field name="name">Decimal Accuracy</field>
                <field name="res_model">decimal.precision</field>
                <field name="domain">[('is_dimension', '=', True)]</field>
        </record>

        <menuitem id="menu_qty_decimal_precision" name="Length, Width and Height Decimal Precision"
                  action="action_decimal_precision_form_inherit"
                  parent="stock.menu_stock_inventory_control" sequence="999"/>

        <menuitem id="menu_purchase_order_report" name="Purchase Order Report"
                  action="purchase_report_wizard_action"
                  parent="purchase.purchase_report_main" sequence="999"/>

    </data>
</odoo>
