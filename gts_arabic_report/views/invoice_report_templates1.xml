<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="report_invoice_with_payments_ar">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="gts_arabic_report.ar_external_layout">
                        <div t-if="o.company_id.pdf_watermark" class="text-center" style="margin:auto;width:80%">
                            <img t-if="o.company_id.pdf_watermark"
                                 t-att-src="'data:image/png;base64,%s' % to_text(o.company_id.pdf_watermark)"
                                 t-attf-style="top:#{o.company_id.pos_from_top}; opacity:#{o.company_id.opacity}; position:absolute;width:80%;height:auto;"/>
                        </div>
                        <t t-set="o" t-value="o.with_context({'lang':o.partner_id.lang})"/>
                        <div class="page" style="font-size: 11px; padding: 2px; font-family: Times and Roman;">
                            <h3 align="center" style="padding-top:10px;">
                                <span t-if="o.move_type == 'out_invoice' and (o.state == 'posted')">
                                    <span>
                                        <strong>VAT INVOICE</strong>
                                    </span>
                                    <br/>
                                    <span class="f-Times and Roman">
                                        <strong>فاتورة ضريبية</strong>
                                    </span>
                                </span>
                                <span t-if="o.move_type == 'out_invoice' and o.state == 'draft'">
                                    <span>
                                        <strong>DRAFT INVOICE</strong>
                                    </span>
                                    <br/>
                                    <span class="f-arial">
                                        <strong>فاتورة مبدئية</strong>
                                    </span>
                                </span>
                                <span t-if="o.move_type == 'out_invoice' and o.state == 'cancel'">
                                    <span>
                                        <strong>CANCELLED INVOICE</strong>
                                    </span>
                                    <br/>
                                    <span class="f-arial">
                                        <strong>فاتورة ملغاة</strong>
                                    </span>
                                </span>
                                <span t-if="o.move_type == 'out_refund'">
                                    <span>
                                        <strong>CREDIT NOTE</strong>
                                    </span>
                                    <br/>
                                    <span class="f-arial">
                                        <strong>إشعار دائن</strong>
                                    </span>
                                </span>
                                <span t-if="o.move_type == 'in_refund'">
                                    <span>
                                        <strong>VENDOR CREDIT NOTE</strong>
                                    </span>
                                    <br/>
                                    <span class="f-arial">
                                        <strong>اشعار دائن للمورد</strong>
                                    </span>
                                </span>
                                <span t-if="o.move_type == 'in_invoice'">
                                    <span>
                                        <strong>VENDOR BILL</strong>
                                    </span>
                                    <br/>
                                    <span class="f-arial">
                                        <strong>فاتورة مورد</strong>
                                    </span>
                                </span>
                            </h3>
                            <table width="100%" class="table-bordered border-black" style="border-spacing: 0;box-sizing: border-box;border: solid 1px black;background-color: #e9dccc;">
                                <thead>
                                    <tr style="font-weight: bold;padding: 3px">
                                        <th colspan="2" style="background-color:#C9C9C9;width: 25%">
                                            Customer Information
                                        </th>
                                        <th colspan="2" class="text-right" style="background-color:#C9C9C9;width: 25%">
                                            بيانات العميل
                                        </th>
                                        <th colspan="2" style="background-color:#C9C9C9;width: 25%">
                                            Invoice Information
                                        </th>
                                        <th colspan="2" class="text-right" style="background-color:#C9C9C9;width: 25%">
                                            بيانات الفاتورة
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="text-center">
                                    <tr style="padding: 3px;">
                                        <td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width: 15%">
                                            Contact
                                            <br/>
                                            التواصل
                                        </td>
                                        <td colspan="3" style="margin:0px" width="35%">
                                            <t t-if="not o.partner_id.parent_id.name">
                                            </t>
                                            <t t-if="o.partner_id.parent_id.name">
                                                <span t-field="o.partner_id.name"/>
                                                <t t-if="o.partner_id.ar_name">
                                                    |
                                                    <span t-field="o.partner_id.ar_name"/>
                                                </t>
                                                <br/>
                                                <span t-if="o.partner_id.mobile" t-field="o.partner_id.mobile"/>
                                                <t t-if="o.partner_id.email and o.partner_id.mobile">
                                                    |
                                                    <span t-field="o.partner_id.email"/>
                                                </t>
                                                <t t-if="o.partner_id.email and not o.partner_id.mobile">
                                                    <span t-field="o.partner_id.email"/>
                                                </t>
                                            </t>
                                        </td>
                                        <td style="font-weight: bold;background-color:#C9C9C9;width: 13%">
                                            Salesperson
                                            <br/>
                                            البائع
                                        </td>
                                        <td colspan="3" width="37%">
                                            <t t-if="o.user_id">
                                                <span t-field="o.user_id"/>
                                                <t t-if="o.user_id and o.user_id.ar_name">
                                                    |
                                                    <span t-field="o.user_id.ar_name"/>
                                                </t>
                                                <br/>
                                                <span t-if="o.user_id.mobile" t-field="o.user_id.mobile"/>
                                                <t t-if="o.user_id.mobile and o.user_id.email">
                                                    |
                                                    <span t-field="o.user_id.email"/>
                                                </t>
                                                <t t-if="not o.user_id.mobile and o.user_id.email">
                                                    <span t-field="o.user_id.email"/>
                                                </t>
                                            </t>
                                            <t t-if="not o.user_id">
                                                <span t-field="o.write_uid"/>
                                                <t t-if="o.write_uid and o.write_uid.ar_name">
                                                    |
                                                    <span t-field="o.write_uid.ar_name"/>
                                                </t>
                                                <br/>
                                                <span t-if="o.write_uid.mobile" t-field="o.write_uid.mobile"/>
                                                <t t-if="o.write_uid.mobile and o.write_uid.email">
                                                    |
                                                    <span t-field="o.write_uid.email"/>
                                                </t>
                                                <t t-if="not o.write_uid.mobile and o.write_uid.email">
                                                    <span t-field="o.write_uid.email"/>
                                                </t>
                                            </t>
                                        </td>
                                    </tr>
                                    <tr style="padding: 3px;">
                                        <td style="font-weight: bold;margin-left:0px; background-color:#C9C9C9;width: 15%">
                                            Company Name
                                            <br/>
                                            اسم الشركة
                                        </td>
                                        <td colspan="3" style="margin:0px" width="35%">
                                            <t t-if="not o.partner_id.parent_id.name">
                                                <span t-field="o.partner_id.name"/>
                                            </t>
                                            <t t-if="o.partner_id.parent_id.name">
                                                <span t-field="o.partner_id.parent_id.name"/>
                                            </t>
                                            <br/>
                                            <t t-if="not o.partner_id.parent_id.name">
                                                <span t-if="o.partner_id.ar_name" t-field="o.partner_id.ar_name"/>
                                            </t>
                                            <t t-if="o.partner_id.parent_id.name">
                                                <span t-if="o.partner_id.parent_id.ar_name"
                                                      t-field="o.partner_id.parent_id.ar_name"/>
                                            </t>
                                        </td>
                                        <td style="font-weight: bold;background-color:#C9C9C9;width: 13%">
                                            Invoice Date
                                            <br/>
                                            تاريخ الفاتورة
                                        </td>
                                        <td colspan="3" width="37%">
                                            <span t-field="o.invoice_date"/>
                                        </td>
                                    </tr>
                                    <tr style="padding: 3px;">
                                        <td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width: 15%">
                                            VAT NO
                                            <br/>
                                            الرقم الضريبي
                                        </td>
                                        <td colspan="3" width="35%">
                                            <span t-field="o.partner_id.vat"/>
                                        </td>
                                        <td style="font-weight: bold;background-color:#C9C9C9;width: 13%">
                                            Due Date
                                            <br/>
                                            تستحق في
                                        </td>
                                        <td colspan="3" width="37%">
                                            <span t-field="o.invoice_date_due"/>
                                        </td>
                                    </tr>
                                    <tr style="padding: 3px;">
                                        <td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width: 15%">
                                            Address
                                            <br/>
                                            العنوان
                                        </td>
                                        <td colspan="3" width="35%">
                                            <t t-if="o.partner_id.street">
                                                <span t-field="o.partner_id.street"/>
                                            </t>
                                            <t t-if="o.partner_id.street2">
                                                ,
                                                <span t-field="o.partner_id.street2"/>
                                            </t>
                                            <t t-if="o.partner_id.state_id">
                                                ,
                                                <span t-field="o.partner_id.state_id.name"/>
                                            </t>
                                            <t t-if="o.partner_id.zip">
                                                ,
                                                <span t-field="o.partner_id.zip"/>
                                            </t>
                                            <br/>
                                            <t t-if="not o.partner_id.parent_id.name">
                                                <t t-if="o.partner_id.ar_street">
                                                    <span t-field="o.partner_id.ar_street"/>
                                                </t>
                                                <t t-if="o.partner_id.state_id">
                                                    ,
                                                    <span t-field="o.partner_id.state_id.ar_name"/>
                                                </t>
                                                <t t-if="o.partner_id.ar_zip">
                                                    ,
                                                    <span t-field="o.partner_id.ar_zip"/>
                                                </t>
                                            </t>
                                            <t t-if="o.partner_id.parent_id.name">
                                                <t t-if="o.partner_id.parent_id.ar_street">
                                                    <span t-field="o.partner_id.parent_id.ar_street"/>
                                                </t>
                                                <t t-if="o.partner_id.parent_id.state_id">
                                                    ,
                                                    <span t-field="o.partner_id.parent_id.state_id.ar_name"/>
                                                </t>
                                                <t t-if="o.partner_id.parent_id.ar_zip">
                                                    ,
                                                    <span t-field="o.partner_id.parent_id.ar_zip"/>
                                                </t>
                                            </t>
                                        </td>
                                        <td style="font-weight: bold;background-color:#C9C9C9;width: 13%">
                                            Invoice#
                                            <br/>
                                            رقم الفاتورة
                                        </td>
                                        <td colspan="3" width="37%">
                                            <t t-if="o.state == 'posted'">
                                                <strong t-field="o.name"/>
                                            </t>
                                            <t t-if="o.state != 'posted'">
                                                <strong>Draft Invoice</strong>
                                                <br/>
                                                <strong>فاتورة مبدئية</strong>
                                            </t>
                                        </td>
                                    </tr>
                                    <tr style="padding: 3px;">
                                        <td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width: 15%">
                                            City
                                            <br/>
                                            المدينة
                                        </td>
                                        <td colspan="3" width="35%">
                                            <span t-if="o.partner_id.city" t-field="o.partner_id.city"/>
                                            <br/>
                                            <t t-if="not o.partner_id.parent_id.name">
                                                <span t-if="o.partner_id.ar_street2" t-field="o.partner_id.ar_street2"/>
                                            </t>
                                            <t t-if="o.partner_id.parent_id.name">
                                                <span t-if="o.partner_id.parent_id.ar_street2"
                                                      t-field="o.partner_id.parent_id.ar_street2"/>
                                            </t>
                                        </td>
<!--                                        <t t-if="o.opportunity_id">-->
<!--                                            <td style="font-weight: bold;background-color:#C9C9C9;width: 13%">-->
<!--                                                Sale Order#-->
<!--                                                <br/>-->
<!--                                                رقم أمر البيع-->
<!--                                            </td>-->
<!--                                            <td width="22%">-->
<!--                                                <span t-field="o.invoice_origin"/>-->
<!--                                            </td>-->
<!--                                        </t>-->
<!--                                        <t t-if="not o.opportunity_id">-->
<!--                                            <td style="font-weight: bold;background-color:#C9C9C9;width: 13%">-->
<!--                                                Sale Order#-->
<!--                                                <br/>-->
<!--                                                رقم أمر البيع-->
<!--                                            </td>-->
<!--                                            <td colspan="3" width="37%">-->
<!--                                                <span t-field="o.invoice_origin"/>-->
<!--                                            </td>-->
<!--                                        </t>-->
<!--                                        <t t-if="o.opportunity_id">-->
<!--                                            <td style="padding: 3px;width:5%">-->
<!--                                                <span t-field="o.opportunity_id.reference_number"/>-->
<!--                                            </td>-->
<!--                                            <td style="font-weight: bold;padding: 3px; background-color:#C9C9C9;width:10%">-->
<!--                                                Internal#-->
<!--                                                <br/>-->
<!--                                                رقم داخلي-->
<!--                                            </td>-->
<!--                                        </t>-->
                                    </tr>
                                    <tr style="padding: 3px;">
                                        <td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width:15%">
                                            Country
                                            <br/>
                                            الدولة
                                        </td>
                                        <td colspan="3" width="35%">
                                            <span t-if="o.partner_id.country_id"
                                                  t-field="o.partner_id.country_id.name"/>
                                            <br/>
                                            <t t-if="not o.partner_id.parent_id.name">
                                                <span t-if="o.partner_id.ar_city" t-field="o.partner_id.ar_city"/>
                                            </t>
                                            <t t-if="o.partner_id.parent_id.name">
                                                <span t-if="o.partner_id.parent_id.ar_city"
                                                      t-field="o.partner_id.parent_id.ar_city"/>
                                            </t>
                                        </td>
                                        <td style="font-weight: bold;background-color:#C9C9C9;width:12%">
                                            Reference/PO
                                            <br/>
                                            رقم أمر شراء
                                        </td>
                                        <td colspan="3" width="37%">
                                            <span t-field="o.ref"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <br/>
                            <table class="table table-bordered border-black" name="invoice_line_table">
                                <thead style="page-break-inside: auto;">
                                    <tr>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black; background-color:#C9C9C9"
                                            width="5%">#
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
                                            Item No.
                                            <br/>
                                            رقم الصنف
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:35%; background-color:#C9C9C9">
                                            Description
                                            <br/>
                                            الوصف
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9"
                                            groups="product.group_uom">
                                            UoM
                                            <br/>
                                            لوحدة
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
                                            Qty
                                            <br/>
                                            الكمیة
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
                                            U/Price
                                            <br/>
                                            سعر الوحدة
                                            <br/>
                                            (<span t-field="o.currency_id"/>)
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
                                            Disc
                                            <br/>
                                            (%)
                                            <br/>
                                            الخصم
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:10%; background-color:#C9C9C9">
                                            Total
                                            excl. VAT
                                            <br/>
                                            المبلغ قبل الضریبة
                                            <br/>
                                            (<span t-field="o.currency_id"/>)
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
                                            VAT(%)
                                            <br/>
                                            نسبة الضریبة
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:10%; background-color:#C9C9C9">
                                            VAT Amount
                                            <br/>
                                            مبلغ الضریبة
                                            <br/>
                                            (<span t-field="o.currency_id"/>)
                                        </th>
                                        <th class="text-center"
                                            style="vertical-align:top;border-top: 1px solid black;width:10%; background-color:#C9C9C9">
                                            Total
                                            incl. VAT
                                            <br/>
                                            إجمالي بعد الضريبة
                                            <br/>
                                            (<span t-field="o.currency_id"/>)
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="invoice_tbody">
                                    <t t-set="total_discount" t-value="0.0"/>
                                    <tr t-foreach="o.get_invoice_lines()" t-as="l" style="page-break-inside: auto;">
                                        <td class="text-center">
                                            <span t-esc="l_index + 1"/>
                                        </td>
                                        <td>
                                            <span t-field="l.product_id.default_code"/>
                                        </td>
                                        <td>
                                            <p style="padding:0px;margin:0px" t-field="l.name"/>
                                            <p style="padding:0px;margin:0px" class="text-right"
                                               t-field="l.product_id.ar_name"/>
                                        </td>
                                        <td class="text-center" groups="product.group_uom">
                                            <span t-field="l.uom_id"/>
                                        </td>
                                        <td class="text-center">
                                            <span t-esc="'{0:,.2f}'.format(float(l.quantity))"/>
                                        </td>
                                        <td class="text-center">
                                            <!--<span t-field="l.price_unit"/> -->
                                            <span t-esc="'{0:,.2f}'.format(float(l.price_unit))"/>
                                        </td>
                                        <td class="text-center">
                                            <span t-field="l.discount"/>%
                                        </td>
                                        <td class="text-center">
                                            <!--<span t-field="l.price_subtotal" t-options="{'display_currency':
                                                False}"/> -->
                                            <span t-esc="'{0:,.2f}'.format(float(l.price_subtotal))"/>
                                        </td>
                                        <td class="text-center">
                                            <span t-esc="', '.join(map(lambda x: (x.description or x.name), l.tax_ids))"/>
                                        </td>
                                        <td class="text-center">
                                            <!--<span t-field="l.line_amount_tax"/> -->
                                            <span t-esc="'{0:,.2f}'.format(float(l.line_amount_tax))"/>
                                        </td>
                                        <td class="text-right" id="subtotal">
                                            <!--<span t-field="l.line_amount_taxed"/> -->
                                            <span t-esc="'{0:,.2f}'.format(float(l.line_amount_taxed))"/>
                                        </td>
                                        <t t-set="total_discount"
                                           t-value="total_discount + ((l.quantity * l.price_unit) - l.price_subtotal)"/>
                                    </tr>
                                </tbody>
                            </table>
                            <table class="table table-bordered border-black" width="100%"
                                   style="page-break-inside:avoid;padding:0px;margin-top:10px;">
                                <thead>
                                    <tr>
                                        <th style="background-color:#C9C9C9;width:65%" class="text-center">
                                            Payment Terms &amp; Conditions
                                            <br/>
                                            قوانين وشروط الدفع
                                        </th>
                                        <th class="text-right" style="background-color:#C9C9C9;width:25%">
                                            Total Before VAT (<span t-field="o.currency_id"/>)
                                            <br/>
                                            (المجموع قبل الضريبة (ر.س
                                        </th>
                                        <th class="text-right" style="width:10%">
                                            <span t-esc="'{0:,.2f}'.format(float(o.amount_untaxed + total_discount))"/>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td rowspan="5">
                                            <div t-if="o.payment_state == 'paid' and o.amount_residual == 0.00">
                                                <div class="text-center"
                                                     style="border: 4px solid red;padding: 4px; border-radius: 10px; height: 100px; font-size: 30px; color:red;   -ms-transform: rotate(-10deg); -webkit-transform: rotate(-10deg); transform: rotate(-10deg);">
                                                    <b>PAID INVOICE</b>
                                                    <hr style="border: 2px solid red; margin-top: 0px;margin-bottom: 0px;padding: 0px"/>
                                                    <p style="font-size: 15px;margin-top:7px;">
                                                        <span t-field="o.paid_user_id.name"/>
                                                        ,
                                                        <span t-field="o.paid_date"/>
                                                    </p>
                                                </div>
                                            </div>
                                            <div t-if="o.payment_state != 'paid'">
                                                <p>
                                                    <t t-if="o.narration">
                                                        <span style="font-weight: bold;">Terms &amp; Conditions:</span>
                                                        <br/>
                                                        <span t-field="o.narration"/>
                                                        <br/>
                                                        <br/>
                                                    </t>
                                                    <t t-if="o.invoice_payment_term_id.note">
                                                        <span style="font-weight: bold;">Payment Terms:</span>
                                                        <br/>
                                                        <span t-field="o.invoice_payment_term_id.note"/>
                                                    </t>
                                                </p>
                                            </div>
                                        </td>
                                        <th class="text-right" style="font-weight: bold;background-color:#C9C9C9">
                                            Total Discount (<span t-field="o.currency_id"/>)
                                            <br/>
                                            (مجموع الخصم (ر.س
                                        </th>
                                        <th class="text-right">
                                            <span t-esc="'{0:,.2f}'.format(float(total_discount))"/>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th class="text-right" style="font-weight: bold;background-color:#C9C9C9">
                                            Final Total before VAT (<span t-field="o.currency_id"/>)
                                            <br/>
                                            (المجموع النهائي قبل الضريبة (ر.س
                                        </th>
                                        <th class="text-right">
                                            <span t-esc="'{0:,.2f}'.format(float(o.amount_untaxed))"/>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th class="text-right" style="font-weight: bold;background-color:#C9C9C9">
                                            Total VAT (<span t-field="o.currency_id"/>)
                                            <br/>
                                            (إجمالي الضريبة المضافة (ر.س
                                        </th>
                                        <th class="text-right">
                                            <span t-esc="'{0:,.2f}'.format(float(o.amount_tax))"/>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th class="text-right" style="font-weight: bold;background-color:#C9C9C9">
                                            Total with VAT (<span t-field="o.currency_id"/>)
                                            <br/>
                                            (إجمالي شامل الضريبة (ر.س
                                        </th>
                                        <th class="text-right">
                                            <span t-esc="'{0:,.2f}'.format(float(o.amount_total))"/>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th class="text-right" style="font-weight: bold;background-color:#C9C9C9">
                                            Due Balance (<span t-field="o.currency_id"/>)
                                            <br/>
                                            (الرصيد المستحق (ر.س
                                        </th>
                                        <th class="text-right" style="font-weight: bold">
                                            <span t-esc="'{0:,.2f}'.format(float(o.amount_residual))"/>
                                        </th>
                                    </tr>
                                </tbody>
                            </table>
                            <p t-if="o.fiscal_position_id.note">
                                <span t-field="o.fiscal_position_id.note"/>
                            </p>
                            <table class="table table-bordered border-black" width="100%"
                                   style="page-break-inside:avoid;padding:0px;margin-top:20px;">
                                <tr style="padding:0px">
                                    <td style="width:88%">
                                        <table class="table table-bordered border-black" style="margin:0px">
                                            <tr>
                                                <td colspan="2"
                                                    style="text-align:left;padding:0px; width:50%;background-color:#C9C9C9;line-height:15px">
                                                    <strong>Bank Account Details</strong>
                                                </td>
                                                <td colspan="2"
                                                    style="text-align:right;padding:0px; width:50%; background-color:#C9C9C9;line-height:15px">
                                                    <strong>تفاصيل الحساب البنكي</strong>
                                                </td>
                                            </tr>
                                            <t t-set="bank"
                                               t-value="o.company_id.partner_id.bank_ids and o.company_id.partner_id.bank_ids[0]"/>
                                            <t t-if="bank">
                                                <tr>
                                                    <td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>Beneficiary</strong>
                                                    </td>
                                                    <td style="text-align:left;padding:0px;width:35%">
                                                        <span t-field="o.company_id.name"/>
                                                    </td>
                                                    <td style="text-align:right;padding:0px;width:35%">
                                                        <span t-field="o.company_id.ar_name"/>
                                                    </td>
                                                    <td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>المستفيد</strong>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>Bank</strong>
                                                    </td>
                                                    <td style="text-align:left;padding:0px;width:35%">
                                                        <span t-field="bank.bank_id.name"/>
                                                    </td>
                                                    <td style="text-align:right;padding:0px;width:35%">
                                                        <span t-field="bank.bank_id.ar_name"/>
                                                    </td>
                                                    <td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>البنك</strong>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>SWIFT</strong>
                                                    </td>
                                                    <td colspan="2" style="text-align:center;padding:0px;width:70%">
                                                        <span t-field="bank.bank_id.swift"/>
                                                    </td>
                                                    <td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>التحويل الدولي</strong>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>Account</strong>
                                                    </td>
                                                    <td colspan="2" style="text-align:center;padding:0px;width:70%">
                                                        <span t-field="bank.acc_number"/>
                                                    </td>
                                                    <td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>الحساب</strong>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>IBAN</strong>
                                                    </td>
                                                    <td colspan="2" style="text-align:center;padding:0px;width:70%">
                                                        <span t-field="bank.bank_id.bic"/>
                                                    </td>
                                                    <td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9">
                                                        <strong>الآيبان</strong>
                                                    </td>
                                                </tr>
                                            </t>
                                        </table>
                                    </td>
                                    <td class="text-center" style="width=12%; valign:middle; padding:0px">
                                        <t t-if="o.state == 'posted'">
                                            <img t-att-src="'/report/barcode/?type=%s&amp;width=%s&amp;height=%s&amp;value=%s'%('QR', 130, 130, o.invoice_data_bae64_string())"/>
                                        </t>
                                        <t t-if="o.state != 'posted'">
                                            <strong>
                                                <h3>
                                                    Draft Invoice
                                                    <br/>
                                                    فاتورة مبدئية
                                                </h3>
                                            </strong>
                                        </t>
                                    </td>
                                </tr>
                            </table>
                            <table width="100%" height="100%" class="table table-bordered border-black"
                                   style="page-break-inside:avoid;margin-top:20px;">
                                <tr style="font-weight: bold;text-align:left;padding:0px;background-color:#C9C9C9">
                                    <th colspan="3" width="50%">
                                        <t t-if="not o.partner_id.parent_id.name">
                                            For<span t-field="o.partner_id"/>, Received and Accepted by
                                        </t>
                                        <t t-if="o.partner_id.parent_id.name">
                                            For<span t-field="o.partner_id.parent_id"/>, Received and Accepted by
                                        </t>
                                    </th>
                                    <th colspan="3" width="50%">
                                        For<span t-field="o.company_id"/>, Reviewed and Approved By
                                    </th>
                                </tr>
                                <tr style="font-weight: bold;text-align:right;padding:0px; background-color:#C9C9C9">
                                    <td colspan="3" width="50%">
                                        <t t-if="not o.partner_id.parent_id.name">
                                            نيابة عن<span t-field="o.partner_id.ar_name"/>، تم الإستلام والقبول من قبل
                                        </t>
                                        <t t-if="o.partner_id.parent_id.name">
                                            نيابة عن<span t-field="o.partner_id.parent_id.ar_name"/>، تم الإستلام
                                            والقبول من قبل
                                        </t>
                                    </td>
                                    <td colspan="3" width="50%">
                                        نيابة عن<span t-field="o.company_id.ar_name"/>، مراجعة و مصادقة من قبل
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;text-align:center;padding:0px; width:10%; background-color:#C9C9C9">
                                        Signature
                                        <br/>
                                        التوقيع
                                    </td>
                                    <td colspan="2" style="text-align:center;width:40%">
                                        <div style="visibility: hidden">
                                            <p>1</p>
                                            <p>2</p>
                                        </div>
                                    </td>
                                    <td style="font-weight: bold;text-align:center;padding:0px; width:10%; background-color:#C9C9C9">
                                        Signature
                                        <br/>
                                        التوقيع
                                    </td>
                                    <td colspan="2" style="width:40%">
                                        <div style="visibility: hidden">
                                            <p>1</p>
                                            <p>2</p>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td width="10%"
                                        style="font-weight: bold;text-align:left;padding:0px; background-color:#C9C9C9">
                                        Date
                                    </td>
                                    <td width="30%">
                                    </td>
                                    <td width="10%"
                                        style="font-weight: bold;text-align:right;padding:0px; background-color:#C9C9C9">
                                        تاريخ
                                    </td>
                                    <td width="10%"
                                        style="font-weight: bold;text-align:left;padding:0px; background-color:#C9C9C9">
                                        Date
                                    </td>
                                    <td width="30%">
                                    </td>
                                    <td width="10%"
                                        style="font-weight: bold;text-align:right;padding:0px; background-color:#C9C9C9">
                                        تاريخ
                                    </td>
                                </tr>
                            </table>
                            <div style="font-size: 9px;page-break-inside:avoid;">
                                <p>
                                    <i>* Original copy of this invoice shall be handed over to the
                                        customer’s accounting
                                        department after obtaining acceptance of the authorized signatory
                                    </i>
                                    <br/>
                                    <i>* Accepted documentation of quotation, delivery note and/or
                                        work completion
                                        certificate shall be attached or referenced in this invoice
                                    </i>
                                </p>
                                <p>
                                    <span>Prepared by:</span>
                                    <span t-esc="user.name"/>
                                    &amp;nbsp; on
                                    <span t-field="o.write_date"/>
                                    &amp;nbsp;&amp;nbsp;
                                    <span>Printed by:</span>
                                    <span t-esc="user.name"/>
                                    &amp;nbsp; on
                                    <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d-%b-%Y %H:%M')"/>
                                </p>
                            </div>
                        </div>
                    </t>
                </t>
            </t>
        </template>
<!--                account.account_invoices-->
        		<report id="account.account_invoices" model="account.move"
        			string="Invoices" report_type="qweb-pdf"
        			name="gts_arabic_report.report_invoice_with_payments_ar"
        			file="gts_arabic_report.report_invoice_with_payments_ar"
        			paperformat="gts_arabic_report.paperformat_arabic_reports"
        			print_report_name="(object.move_type=='out_invoice' and object.state == 'posted') and '%s-VAT-Invoice-%s' %(object.company_id,object.name)
        			or (object.move_type == 'out_invoice' and object.state == 'draft') and  '%s-Draft-Invoice-%s' % (object.company_id.company_short_name,object.name)
        			or (object.move_type == 'out_invoice' and object.state == 'cancel') and  '%s-Cancelled-Invoice-%s' % (object.company_id.company_short_name,object.name)
        			or (object.move_type == 'out_refund') and  '%s-Credit-Note-%s' % (object.company_id.company_short_name,object.name)
                    or (object.move_type == 'in_refund') and  '%s-Vendor-Credit-Note-%s' % (object.company_id.company_short_name,object.name)
         			or (object.move_type == 'in_invoice') and  '%s-Vendor-Bill-%s' % (object.company_id.company_short_name,object.name)"
        		/>


        <!--<record id="account_invoices_ar" model="ir.actions.report.xml"> <field
            name="paperformat_id" ref="arabic_report.paperformat_arabic_reports"/> <field
            name="print_report_name">'Vision_Arabia_Invoice_'+(object.number or '')+'.pdf'</field>
            </record> -->




		<template id="report_invoice_with_payments_ar_common">
			<t t-call="web.html_container">
				<t t-if="report_type == 'html'">
					<div t-call="gts_arabic_report.invoice_order_portal_content"/>
				</t>
				<t t-if="report_type != 'html'">
					<div t-call="gts_arabic_report.report_invoice_with_payments_ar"/>
				</t>
			</t>
		</template>

		<template id="report_invoice_with_payments_ar">
<!--			<t t-call="web.html_container">-->
			<t t-foreach="docs" t-as="o">
			<t t-call="gts_arabic_report.ar_external_layout">
				<div t-if="o.company_id.pdf_watermark" class="text-center" style="margin:auto;width:80%">
					<img t-if="o.company_id.pdf_watermark" t-att-src="'data:image/png;base64,%s' % to_text(o.company_id.pdf_watermark)" t-attf-style="top:#{o.company_id.pos_from_top}; opacity:#{o.company_id.opacity}; position:absolute;width:80%;height:auto;"/>
				</div>
				<t t-set="o" t-value="o.with_context({'lang':o.partner_id.lang})"/>
				<div class="page" style="font-size: 11px; padding: 2px; font-family: Times and Roman;">
					<h3 align="center" style="padding-top:10px;">
						<span t-if="o.move_type == 'out_invoice' and (o.state == 'posted')">
							<span>
								<strong>VAT INVOICE</strong>
							</span>
							<br/>
							<span class="f-Times and Roman">
								<strong>فاتورة ضريبية</strong>
							</span>
						</span>
						<span t-if="o.move_type == 'out_invoice' and o.state == 'draft'">
							<span>
								<strong>DRAFT INVOICE</strong>
							</span>
							<br/>
							<span class="f-arial">
								<strong>فاتورة مبدئية</strong>
							</span>
						</span>
						<span t-if="o.move_type == 'out_invoice' and o.state == 'cancel'">
							<span>
								<strong>CANCELLED INVOICE</strong>
							</span>
							<br/>
							<span class="f-arial">
								<strong>فاتورة ملغاة</strong>
							</span>
						</span>
						<span t-if="o.move_type == 'out_refund'">
							<span>
								<strong>CREDIT NOTE</strong>
							</span>
							<br/>
							<span class="f-arial">
								<strong>إشعار دائن</strong>
							</span>
						</span>
						<span t-if="o.move_type == 'in_refund'">
							<span>
								<strong>VENDOR CREDIT NOTE</strong>
							</span>
							<br/>
							<span class="f-arial">
								<strong>اشعار دائن للمورد</strong>
							</span>
						</span>
						<span t-if="o.move_type == 'in_invoice'">
							<span>
								<strong>VENDOR BILL</strong>
							</span>
							<br/>
							<span class="f-arial">
								<strong>فاتورة مورد</strong>
							</span>
						</span>
					</h3>
					<table width="100%" class="table-bordered border-black">
						<thead>
							<tr style="font-weight: bold;padding: 3px">
								<th colspan="2" style="background-color:#C9C9C9;width: 25%">
									Customer Information
								</th>
								<th colspan="2" class="text-right" style="background-color:#C9C9C9;width: 25%">
									بيانات العميل
								</th>
								<th colspan="2" style="background-color:#C9C9C9;width: 25%">
									Invoice Information
								</th>
								<th colspan="2" class="text-right" style="background-color:#C9C9C9;width: 25%">
									بيانات الفاتورة
								</th>
							</tr>
						</thead>
						<tbody class="text-center">
							<tr style="padding: 3px;">
								<td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width: 15%">
									Contact
									<br/>
									التواصل
								</td>
								<td colspan="3" style="margin:0px"  width="35%">
									<t t-if="not o.partner_id.parent_id.name">
									</t>
									<t t-if="o.partner_id.parent_id.name">
										<span t-field="o.partner_id.name"/>
										<t t-if="o.partner_id.ar_name">
											| <span t-field="o.partner_id.ar_name"/>
										</t>
										<br/>
										<span t-if="o.partner_id.mobile" t-field="o.partner_id.mobile"/>
										<t t-if="o.partner_id.email and o.partner_id.mobile">
											| <span t-field="o.partner_id.email"/>
										</t>
										<t t-if="o.partner_id.email and not o.partner_id.mobile">
											<span t-field="o.partner_id.email"/>
										</t>
									</t>
								</td>
								<td style="font-weight: bold;background-color:#C9C9C9;width: 13%">
									Salesperson
									<br/>
									البائع
								</td>
								<td colspan="3"  width="37%">
									<t t-if="o.user_id">
										<span t-field="o.user_id"/>
										<t t-if="o.user_id and o.user_id.ar_name">
											| <span t-field="o.user_id.ar_name"/>
										</t>
										<br/>
										<span t-if="o.user_id.mobile" t-field="o.user_id.mobile"/>
										<t t-if="o.user_id.mobile and o.user_id.email">
											| <span t-field="o.user_id.email"/>
										</t>
										<t t-if="not o.user_id.mobile and o.user_id.email">
											<span t-field="o.user_id.email"/>
										</t>
									</t>
									<t t-if="not o.user_id">
										<span t-field="o.write_uid"/>
										<t t-if="o.write_uid and o.write_uid.ar_name">
											| <span t-field="o.write_uid.ar_name"/>
										</t>
										<br/>
										<span t-if="o.write_uid.mobile" t-field="o.write_uid.mobile"/>
										<t t-if="o.write_uid.mobile and o.write_uid.email">
											| <span t-field="o.write_uid.email"/>
										</t>
										<t t-if="not o.write_uid.mobile and o.write_uid.email">
											<span t-field="o.write_uid.email"/>
										</t>
									</t>
								</td>
							</tr>
							<tr style="padding: 3px;">
								<td style="font-weight: bold;margin-left:0px; background-color:#C9C9C9;width: 15%">
									Company Name
									<br/>
									اسم الشركة
								</td>
								<td colspan="3" style="margin:0px"  width="35%">
									<t t-if="not o.partner_id.parent_id.name">
										<span t-field="o.partner_id.name"/>
									</t>
									<t t-if="o.partner_id.parent_id.name">
										<span t-field="o.partner_id.parent_id.name"/>
									</t>
									<br/>
									<t t-if="not o.partner_id.parent_id.name">
										<span t-if="o.partner_id.ar_name" t-field="o.partner_id.ar_name"/>
									</t>
									<t t-if="o.partner_id.parent_id.name">
										<span t-if="o.partner_id.parent_id.ar_name" t-field="o.partner_id.parent_id.ar_name"/>
									</t>
								</td>
								<td style="font-weight: bold;background-color:#C9C9C9;width: 13%">
									Invoice Date
									<br/>
									تاريخ الفاتورة
								</td>
								<td colspan="3"  width="37%">
									<span t-field="o.invoice_date"/>
								</td>
							</tr>
							<tr style="padding: 3px;">
								<td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width: 15%">
									VAT NO
									<br/>
									الرقم الضريبي
								</td>
								<td colspan="3"  width="35%">
									<span t-field="o.partner_id.vat"/>
								</td>
								<td style="font-weight: bold;background-color:#C9C9C9;width: 13%">
									Due Date
									<br/>
									تستحق في
								</td>
								<td colspan="3"  width="37%">
									<span t-field="o.invoice_date_due"/>
								</td>
							</tr>
							<tr style="padding: 3px;">
								<td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width: 15%">
									Address
									<br/>
									العنوان
								</td>
								<td colspan="3"  width="35%">
									<t t-if="o.partner_id.street">
										<span t-field="o.partner_id.street"/>
									</t>
									<t t-if="o.partner_id.street2">
										,<span t-field="o.partner_id.street2"/>
									</t>
									<t t-if="o.partner_id.state_id">
										,<span t-field="o.partner_id.state_id.name"/>
									</t>
									<t t-if="o.partner_id.zip">
										,<span t-field="o.partner_id.zip"/>
									</t>
									<br/>
									<t t-if="not o.partner_id.parent_id.name">
										<t t-if="o.partner_id.ar_street">
											<span t-field="o.partner_id.ar_street"/>
										</t>
										<t t-if="o.partner_id.state_id">
											,<span t-field="o.partner_id.state_id.ar_name"/>
										</t>
										<t t-if="o.partner_id.ar_zip">
											,<span t-field="o.partner_id.ar_zip"/>
										</t>
									</t>
									<t t-if="o.partner_id.parent_id.name">
										<t t-if="o.partner_id.parent_id.ar_street">
											<span t-field="o.partner_id.parent_id.ar_street"/>
										</t>
										<t t-if="o.partner_id.parent_id.state_id">
											,<span t-field="o.partner_id.parent_id.state_id.ar_name"/>
										</t>
										<t t-if="o.partner_id.parent_id.ar_zip">
											,<span t-field="o.partner_id.parent_id.ar_zip"/>
										</t>
									</t>
								</td>
								<td style="font-weight: bold;background-color:#C9C9C9;width: 13%">
									Invoice#
									<br/>
									رقم الفاتورة
								</td>
								<td colspan="3"  width="37%">
									<t t-if="o.state == 'posted'">
										<strong t-field="o.name"/>
									</t>
									<t t-if="o.state != 'posted'">
										<strong>Draft Invoice</strong>
										<br/>
										<strong>فاتورة مبدئية</strong>
									</t>
								</td>
							</tr>
							<tr style="padding: 3px;">
								<td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width: 15%">
									City
									<br/>
									المدينة
								</td>
								<td colspan="3"  width="35%">
									<span t-if="o.partner_id.city" t-field="o.partner_id.city"/>
									<br/>
									<t t-if="not o.partner_id.parent_id.name">
										<span t-if="o.partner_id.ar_street2" t-field="o.partner_id.ar_street2"/>
									</t>
									<t t-if="o.partner_id.parent_id.name">
										<span t-if="o.partner_id.parent_id.ar_street2" t-field="o.partner_id.parent_id.ar_street2"/>
									</t>
								</td>
<!--								<t t-if="o.opportunity_id">-->
<!--									<td style="font-weight: bold;background-color:#C9C9C9;width: 13%">-->
<!--										Sale Order#-->
<!--										<br/>-->
<!--										رقم أمر البيع-->
<!--									</td>-->
<!--									<td  width="22%">-->
<!--										<span t-field="o.invoice_origin"/>-->
<!--									</td>-->
<!--								</t>-->
<!--								<t t-if="not o.opportunity_id">-->
<!--									<td style="font-weight: bold;background-color:#C9C9C9;width: 13%">-->
<!--										Sale Order#-->
<!--										<br/>-->
<!--										رقم أمر البيع-->
<!--									</td>-->
<!--									<td colspan="3"  width="37%">-->
<!--										<span t-field="o.invoice_origin"/>-->
<!--									</td>-->
<!--								</t>-->
<!--								<t t-if="o.opportunity_id">-->
<!--									<td  style="padding: 3px;width:5%">-->
<!--										<span t-field="o.opportunity_id.reference_number"/>-->
<!--									</td>-->
<!--									<td style="font-weight: bold;padding: 3px; background-color:#C9C9C9;width:10%">-->
<!--										Internal#-->
<!--										<br/>-->
<!--										رقم داخلي-->
<!--									</td>-->
<!--								</t>-->
							</tr>
							<tr style="padding: 3px;">
									<td style="font-weight: bold;margin-left:0px;background-color:#C9C9C9;width:15%">
										Country
										<br/>
										الدولة
									</td>
									<td colspan="3"  width="35%">
										<span t-if="o.partner_id.country_id" t-field="o.partner_id.country_id.name"/>
										<br/>
										<t t-if="not o.partner_id.parent_id.name">
											<span t-if="o.partner_id.ar_city" t-field="o.partner_id.ar_city"/>
										</t>
										<t t-if="o.partner_id.parent_id.name">
											<span t-if="o.partner_id.parent_id.ar_city" t-field="o.partner_id.parent_id.ar_city"/>
										</t>
									</td>
								<td style="font-weight: bold;background-color:#C9C9C9;width:12%">
									Reference/PO
									<br/>
									رقم أمر شراء
								</td>
								<td colspan="3"  width="37%">
									<span t-field="o.ref"/>
								</td>
							</tr>
						</tbody>
					</table>
					<br/>
					<table class="table table-bordered border-black" name="invoice_line_table">
						<thead style="page-break-inside: auto;">
							<tr>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black; background-color:#C9C9C9" width="5%">#</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
									Item No.
									<br/>
									رقم الصنف
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:35%; background-color:#C9C9C9">
									Description
									<br/>
									الوصف
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9" groups="product.group_uom">
									UoM
									<br/>
									لوحدة
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
									Qty
									<br/>
									الكمیة
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
									U/Price
									<br/>
									سعر الوحدة
									<br/>
									(<span t-field="o.currency_id"/>)
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
									Disc
									<br/>
									(%)
									<br/>
									الخصم
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:10%; background-color:#C9C9C9">
									Total
									excl. VAT
									<br/>
									المبلغ قبل الضریبة
									<br/>
									(<span t-field="o.currency_id"/>)
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:5%; background-color:#C9C9C9">
									VAT(%)
									<br/>
									نسبة الضریبة
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:10%; background-color:#C9C9C9">
									VAT Amount
									<br/>
									مبلغ الضریبة
									<br/>
									(<span t-field="o.currency_id"/>)
								</th>
								<th class="text-center" style="vertical-align:top;border-top: 1px solid black;width:10%; background-color:#C9C9C9">
									Total
									incl. VAT
									<br/>
									إجمالي بعد الضريبة
									<br/>
									(<span t-field="o.currency_id"/>)
								</th>
							</tr>
						</thead>
						<tbody class="invoice_tbody">
							<t t-set="total_discount" t-value="0.0"/>
							<tr t-foreach="o.get_invoice_lines()" t-as="l" style="page-break-inside: auto;">
								<td class="text-center">
									<span t-esc="l_index + 1"/>
								</td>
								<td>
									<span t-field="l.product_id.default_code"/>
								</td>
								<td>
									<p style="padding:0px;margin:0px" t-field="l.name"/>
									<p style="padding:0px;margin:0px" class="text-right" t-field="l.product_id.ar_name"/>
								</td>
								<td class="text-center" groups="product.group_uom">
									<span t-field="l.uom_id"/>
								</td>
								<td class="text-center">
									<span t-esc="'{0:,.2f}'.format(float(l.quantity))"/>
								</td>
								<td class="text-center">
									<!--<span t-field="l.price_unit"/> -->
									<span t-esc="'{0:,.2f}'.format(float(l.price_unit))"/>
								</td>
								<td class="text-center">
									<span t-field="l.discount"/>%
								</td>
								<td class="text-center">
									<!--<span t-field="l.price_subtotal" t-options="{'display_currency':
										False}"/> -->
									<span t-esc="'{0:,.2f}'.format(float(l.price_subtotal))"/>
								</td>
								<td class="text-center">
									<span t-esc="', '.join(map(lambda x: (x.description or x.name), l.tax_ids))"/>
								</td>
								<td class="text-center">
									<!--<span t-field="l.line_amount_tax"/> -->
									<span t-esc="'{0:,.2f}'.format(float(l.line_amount_tax))"/>
								</td>
								<td class="text-right" id="subtotal">
									<!--<span t-field="l.line_amount_taxed"/> -->
									<span t-esc="'{0:,.2f}'.format(float(l.line_amount_taxed))"/>
								</td>
								<t t-set="total_discount" t-value="total_discount + ((l.quantity * l.price_unit) - l.price_subtotal)"/>
							</tr>
						</tbody>
					</table>
					<table class="table table-bordered border-black" width="100%" style="page-break-inside:avoid;padding:0px;margin-top:10px;">
						<thead>
							<tr>
								<th style="background-color:#C9C9C9;width:65%" class="text-center">
									Payment Terms &amp; Conditions
									<br/>
									قوانين وشروط الدفع
								</th>
								<th class="text-right" style="background-color:#C9C9C9;width:25%">
									Total Before VAT (<span t-field="o.currency_id"/>)
									<br/>
									(المجموع قبل الضريبة (ر.س
								</th>
								<th class="text-right" style="width:10%">
									<span t-esc="'{0:,.2f}'.format(float(o.amount_untaxed + total_discount))"/>
								</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td rowspan="5">
									<div t-if="o.payment_state == 'paid' and o.amount_residual == 0.00">
										<div class="text-center" style="border: 4px solid red;padding: 4px; border-radius: 10px; height: 100px; font-size: 30px; color:red;   -ms-transform: rotate(-10deg); -webkit-transform: rotate(-10deg); transform: rotate(-10deg);">
											<b>PAID INVOICE</b>
											<hr style="border: 2px solid red; margin-top: 0px;margin-bottom: 0px;padding: 0px"/>
											<p style="font-size: 15px;margin-top:7px;">
												<span t-field="o.paid_user_id.name"/>
												,
												<span t-field="o.paid_date"/>
											</p>
										</div>
									</div>
									<div t-if="o.payment_state != 'paid'">
										<p>
											<t t-if="o.narration">
												<span  style="font-weight: bold;">Terms &amp; Conditions:</span>
												<br/>
												<span t-field="o.narration"/>
												<br/>
												<br/>
											</t>
											<t t-if="o.invoice_payment_term_id.note">
												<span  style="font-weight: bold;">Payment Terms:</span>
												<br/>
												<span t-field="o.invoice_payment_term_id.note"/>
											</t>
										</p>
									</div>
								</td>
								<th class="text-right" style="font-weight: bold;background-color:#C9C9C9" >
									Total Discount (<span t-field="o.currency_id"/>)
									<br/>
									(مجموع الخصم (ر.س
								</th>
								<th class="text-right">
									<span t-esc="'{0:,.2f}'.format(float(total_discount))"/>
								</th>
							</tr>
							<tr>
								<th class="text-right" style="font-weight: bold;background-color:#C9C9C9" >
									Final Total before VAT (<span t-field="o.currency_id"/>)
									<br/>
									(المجموع النهائي قبل الضريبة (ر.س
								</th>
								<th class="text-right">
									<span t-esc="'{0:,.2f}'.format(float(o.amount_untaxed))"/>
								</th>
							</tr>
							<tr>
								<th class="text-right" style="font-weight: bold;background-color:#C9C9C9" >
									Total VAT (<span t-field="o.currency_id"/>)
									<br/>
									(إجمالي الضريبة المضافة (ر.س
								</th>
								<th class="text-right">
									<span t-esc="'{0:,.2f}'.format(float(o.amount_tax))"/>
								</th>
							</tr>
							<tr>
								<th class="text-right" style="font-weight: bold;background-color:#C9C9C9" >
									Total with VAT (<span t-field="o.currency_id"/>)
									<br/>
									(إجمالي شامل الضريبة (ر.س
								</th>
								<th class="text-right">
									<span t-esc="'{0:,.2f}'.format(float(o.amount_total))"/>
								</th>
							</tr>
							<tr>
								<th class="text-right" style="font-weight: bold;background-color:#C9C9C9" >
									Due Balance (<span t-field="o.currency_id"/>)
									<br/>
									(الرصيد المستحق (ر.س
								</th>
								<th class="text-right" style="font-weight: bold">
									<span t-esc="'{0:,.2f}'.format(float(o.amount_residual))"/>
								</th>
							</tr>
						</tbody>
					</table>
					<p t-if="o.fiscal_position_id.note">
						<span t-field="o.fiscal_position_id.note"/>
					</p>
					<table class="table table-bordered border-black" width="100%" style="page-break-inside:avoid;padding:0px;margin-top:20px;">
						<tr style="padding:0px">
							<td style="width:88%">
								<table class="table table-bordered border-black" style="margin:0px">
									<tr>
										<td colspan="2" style="text-align:left;padding:0px; width:50%;background-color:#C9C9C9;line-height:15px"><strong>Bank Account Details</strong></td>
										<td colspan="2" style="text-align:right;padding:0px; width:50%; background-color:#C9C9C9;line-height:15px"><strong>تفاصيل الحساب البنكي</strong></td>
									</tr>
									<t t-set="bank" t-value="o.company_id.partner_id.bank_ids and o.company_id.partner_id.bank_ids[0]"/>
									<t t-if="bank">
									<tr>
										<td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9"><strong>Beneficiary</strong></td>
										<td style="text-align:left;padding:0px;width:35%"><span t-field="o.company_id.name"/></td>
										<td style="text-align:right;padding:0px;width:35%"><span t-field="o.company_id.ar_name"/></td>
										<td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9"><strong>المستفيد</strong></td>
									</tr>
									<tr>
										<td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9"><strong>Bank</strong></td>
										<td style="text-align:left;padding:0px;width:35%"><span t-field="bank.bank_id.name"/></td>
										<td style="text-align:right;padding:0px;width:35%"><span t-field="bank.bank_id.ar_name"/></td>
										<td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9"><strong>البنك</strong></td>
									</tr>
									<tr>
										<td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9"><strong>SWIFT</strong></td>
										<td colspan="2" style="text-align:center;padding:0px;width:70%"><span t-field="bank.bank_id.swift"/></td>
										<td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9"><strong>التحويل الدولي</strong></td>
									</tr>
									<tr>
										<td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9"><strong>Account</strong></td>
										<td colspan="2" style="text-align:center;padding:0px;width:70%"><span t-field="bank.acc_number"/></td>
										<td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9"><strong>الحساب</strong></td>
									</tr>
									<tr>
										<td style="text-align:left;padding:0px;width:15%; background-color:#C9C9C9"><strong>IBAN</strong></td>
										<td colspan="2" style="text-align:center;padding:0px;width:70%"><span t-field="bank.bank_id.bic"/></td>
										<td style="text-align:right;padding:0px;width:15%; background-color:#C9C9C9"><strong>الآيبان</strong></td>
									</tr>
									</t>
								</table>
							</td>
							<td class="text-center" style="width=12%; valign:middle; padding:0px">
								<t t-if="o.state == 'posted'">
									<img t-att-src="'/report/barcode/?type=%s&amp;width=%s&amp;height=%s&amp;value=%s'%('QR', 130, 130, o.invoice_data_bae64_string())"/>
								</t>
								<t t-if="o.state != 'posted'">
									<strong>
										<h3>
											Draft Invoice
											<br/>
											فاتورة مبدئية
										</h3>
									</strong>
								</t>
							</td>
						</tr>
					</table>
					<table width="100%" height="100%" class="table table-bordered border-black" style="page-break-inside:avoid;margin-top:20px;">
						<tr style="font-weight: bold;text-align:left;padding:0px;background-color:#C9C9C9">
							<th colspan="3" width="50%">
								<t t-if="not o.partner_id.parent_id.name">
									For <span t-field="o.partner_id"/>, Received and Accepted by
								</t>
								<t t-if="o.partner_id.parent_id.name">
									For <span t-field="o.partner_id.parent_id"/>, Received and Accepted by
								</t>
							</th>
							<th colspan="3" width="50%">
								For <span t-field="o.company_id"/>, Reviewed and Approved By
							</th>
						</tr>
						<tr style="font-weight: bold;text-align:right;padding:0px; background-color:#C9C9C9">
							<td colspan="3" width="50%">
								<t t-if="not o.partner_id.parent_id.name">
									نيابة عن <span t-field="o.partner_id.ar_name"/>، تم الإستلام والقبول من قبل
								</t>
								<t t-if="o.partner_id.parent_id.name">
									نيابة عن <span t-field="o.partner_id.parent_id.ar_name"/>، تم الإستلام والقبول من قبل
								</t>
							</td>
							<td colspan="3" width="50%">
								نيابة عن <span t-field="o.company_id.ar_name"/>، مراجعة و مصادقة من قبل
							</td>
						</tr>
						<tr>
							<td  style="font-weight: bold;text-align:center;padding:0px; width:10%; background-color:#C9C9C9">
								Signature
								<br/>
								التوقيع
							</td>
							<td colspan="2" style="text-align:center;width:40%">
								<div style="visibility: hidden">
									<p>1</p>
									<p>2</p>
								</div>
							</td>
							<td  style="font-weight: bold;text-align:center;padding:0px; width:10%; background-color:#C9C9C9">
								Signature
								<br/>
								التوقيع
							</td>
							<td colspan="2" style="width:40%">
								<div style="visibility: hidden">
									<p>1</p>
									<p>2</p>
								</div>
							</td>
						</tr>
						<tr>
							<td width="10%" style="font-weight: bold;text-align:left;padding:0px; background-color:#C9C9C9">
								Date
							</td>
							<td width="30%">
							</td>
							<td width="10%" style="font-weight: bold;text-align:right;padding:0px; background-color:#C9C9C9">
								تاريخ
							</td>
							<td width="10%" style="font-weight: bold;text-align:left;padding:0px; background-color:#C9C9C9">
								Date
							</td>
							<td width="30%">
							</td>
							<td width="10%" style="font-weight: bold;text-align:right;padding:0px; background-color:#C9C9C9">
								تاريخ
							</td>
						</tr>
					</table>
					<div style="font-size: 9px;page-break-inside:avoid;">
						<p>
							<i>* Original copy of this invoice shall be handed over to the
								customer’s accounting
								department after obtaining acceptance of the authorized signatory
							</i>
							<br/>
							<i>* Accepted documentation of quotation, delivery note and/or
								work completion
								certificate shall be attached or referenced in this invoice
							</i>
						</p>
						<p>
							<span>Prepared by:</span>
							<span t-esc="user.name"/>
							&amp;nbsp; on
							<span t-field="o.write_date"/>
							&amp;nbsp;&amp;nbsp;
							<span>Printed by:</span>
							<span t-esc="user.name"/>
							&amp;nbsp; on
							<span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d-%b-%Y %H:%M')"/>
						</p>
					</div>
				</div>
			</t>
		</t>
<!--	</t>-->
		</template>

		<report id="account.account_invoices" model="account.move"
			string="Invoices" report_type="qweb-pdf"
			name="gts_arabic_report.report_invoice_with_payments_ar_common"
			file="gts_arabic_report.report_invoice_with_payments_ar_common"
			paperformat="gts_arabic_report.paperformat_arabic_reports"
			print_report_name="(object.move_type=='out_invoice' and object.state == 'posted') and '%s-VAT-Invoice-%s' %(object.company_id.company_short_name,object.name)
			 or (object.move_type == 'out_invoice' and object.state == 'draft') and  '%s-Draft-Invoice-%s' % (object.company_id.company_short_name,object.name)
			or (object.move_type == 'out_invoice' and object.state == 'cancel') and  '%s-Cancelled-Invoice-%s' % (object.company_id.company_short_name,object.name)
			or (object.move_type == 'out_refund') and  '%s-Credit-Note-%s' % (object.company_id.company_short_name,object.name)
            or (object.move_type == 'in_refund') and  '%s-Vendor-Credit-Note-%s' % (object.company_id.company_short_name,object.name)
 			or (object.move_type == 'in_invoice') and  '%s-Vendor-Bill-%s' % (object.company_id.company_short_name,object.name)"
		/>


		<template id="invoice_order_portal_content" name="Invoice Order Portal Content">
        <!-- Intro -->
			<t t-foreach="docs" t-as="invoice">
        <div style="margin-left:-50px !important; margin-right:-50px !important; " id="introduction" t-attf-class=" #{'card-header bg-white' if report_type == 'html' else ''}">
          <h3 class="my-0 text-center" style="background-color:#f8f9fa; padding:10px;">
          	<strong>
			  <t t-if="invoice.state not in ('posted','cancel')">
					<span>DRAFT INVOICE</span><br/>
                  <span>فاتورة مبدئية</span>
				</t>
				<t t-if="invoice.state == 'posted'">
					<span>VAT INVOICE</span><br/>
                    <span>فاتورة ضريبية </span>

				</t>
			</strong>

                <!-- <t t-esc="invoice.type_name"/>
                <em t-esc="invoice.name"/> -->
            </h3>


        </div>

        <div style="margin-left:-35px !important; margin-right:-35px !important; "  t-attf-class="#{'card-body' if report_type == 'html' else ''}">
            <!-- Informations -->
            <div id="informations">
                <div t-if="invoice.transaction_ids and not invoices and invoice.state in ('sent', 'sale') and portal_confirmation == 'pay' and not success and not error" t-att-data-order-id="invoice.id">
                    <t t-if="invoice.transaction_ids">
                        <t t-call="payment.payment_confirmation_status">
                            <t t-set="payment_tx_id" t-value="invoice.get_portal_last_transaction()"/>
                            <t t-set="reference" t-value="invoice.reference"/>
                        </t>
                    </t>
                </div>
                <div class="row" id="so_date">
                    <div class="mb-3 col-6">
                        <strong>Invoice Date:</strong>
                      <span t-field="invoice.invoice_date" t-options="{&quot;widget&quot;: &quot;date&quot;}"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6">
                        <strong t-if="invoice.partner_id" class="d-block mb-1">Invoicing Address:</strong>
                        <address t-field="invoice.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: True}"/>
                    </div>
                     <t t-if="invoice.partner_id != invoice.partner_id">
                        <div id="shipping_address" class="col-lg-6">
                            <strong class="d-block mb-1">Shipping Address:</strong>
                            <address t-field="invoice.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;], &quot;no_marker&quot;: True}"/>
                        </div>
                    </t>
                </div>
            </div>

            <section id="details" style="page-break-inside: auto;" class="mt32">
                <h3 id="details">Pricing</h3>

                <t t-set="display_discount" t-value="True in [line.discount &gt; 0 for line in invoice.invoice_line_ids]"/>

                <table t-att-data-order-id="invoice.id" t-att-data-token="invoice.access_token" class="table table-sm" id="invoie_order_table">
                    <thead class="bg-100">
                        <tr>
                            <th class="text-left">Products</th>
                            <th class="text-right">Quantity</th>
                            <th t-attf-class="text-right {{ 'd-none d-sm-table-cell' if report_type == 'html' else '' }}">Unit Price</th>

                            <th t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                <span>Taxes</span>
                            </th>
                            <th class="text-right">
                                <span groups="account.group_show_line_subtotals_tax_excluded">Amount</span>
                                <span groups="account.group_show_line_subtotals_tax_included">Total Price</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="sale_tbody">

                        <t t-set="current_subtotal" t-value="0"/>
                        <t t-set="tax_amount" t-value="0"/>

                        <t t-foreach="invoice.invoice_line_ids" t-as="line">

                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                            <t t-set="tax_amount" t-value="tax_amount + line.price_subtotal"/>

                            <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                <t t-if="not line.display_type">
                                    <td id="product_name">
										<div>
											<span t-field="line.name"/>
										</div>
										<div class="text-right">
											<span t-esc="line.product_id.ar_name"/>
										</div>
									</td>
                                    <td class="text-right">
                                        <div id="quote_qty">
                                            <span t-field="line.quantity"/>
                                            <span t-field="line.product_uom_id"/>
                                        </div>
                                    </td>
									<td t-attf-class="text-right {{ 'd-none d-sm-table-cell' if report_type == 'html' else '' }}">
                                        <div id="quote_qty">
                                            <span t-field="line.price_unit"/>
<!--                                            <span t-field="line.product_uom_id"/>-->
                                        </div>
                                    </td>

                                    <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                        <span t-esc="', '.join(map(lambda x: (x.description or x.name), line.tax_ids))"/>
                                    </td>
                                    <td class="text-right">
                                        <span class="oe_order_line_price_subtotal" t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                        <span class="oe_order_line_price_total" t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_included"/>
                                    </td>
                                </t>
                                <t t-if="line.display_type == 'line_section'">
                                    <td colspan="99">
                                        <div>
											<span t-field="line.name"/>
										</div>
										<div class="text-right">
											<span t-esc="line.product_id.ar_name"/>
										</div>
                                    </td>
                                    <t t-set="current_section" t-value="line"/>
                                    <t t-set="current_subtotal" t-value="0"/>
                                </t>
                                <t t-if="line.display_type == 'line_note'">
                                    <td colspan="99">
                                        <div>
											<span t-field="line.name"/>
										</div>
										<div class="text-right">
											<span t-esc="line.product_id.ar_name"/>
										</div>
                                    </td>
                                </t>
                            </tr>

                            <t t-if="current_section and (line_last or invoice.invoice_line_ids[line_index+1].display_type == 'line_section')">
                                <tr class="is-subtotal text-left">
                                    <td colspan="99">
                                        <strong class="mr16">Subtotal:</strong>
                                        <span style="margin-left:5% !important;" t-esc="current_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: invoice.currency_id}"/>
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                </table>
                <table align="right" style="background-color:#f8f9fa;">
                     <tr>
                        <td style="width:100px;padding:0 10px;"><b>Subtotal : </b></td>
                        <td><b><span t-field="invoice.amount_untaxed"/></b></td>
                    </tr>
                    <tr>
                        <td style="padding:0 10px;"><b>Tax : </b></td>
                        <td><b><span t-field="invoice.amount_tax"/></b></td>
                    </tr>
                    <tr>
                        <td style="padding:0 10px;"><b>Total : </b></td>
                        <td><b>
                            <span t-field="invoice.amount_total"/> </b>
                        </td>
                    </tr>
                </table>
            </section>
            <br/>
            <section id="terms" class="mt-5" t-if="invoice.narration">
                <h4 class="">Terms &amp; Conditions</h4>
                <hr class="mt-0 mb-1"/>
                <em t-field="invoice.narration"/>
            </section>
            <br/>

            <section class="mt-5" t-if="invoice.invoice_payment_term_id">
                <h4 class="">Payment terms</h4>
                <hr class="mt-0 mb-1"/>
                <span t-field="invoice.invoice_payment_term_id.note"/>
            </section>
        </div>
			</t>
    </template>



        <template id="account.portal_invoice_page" name="Invoice Portal Template" inherit_id="portal.portal_sidebar" primary="True">
        <xpath expr="//div[hasclass('o_portal_sidebar')]" position="inside">
            <t t-set="o_portal_fullwidth_alert" groups="sales_team.group_sale_salesman,account.group_account_invoice,account.group_account_readonly">
                <t t-call="portal.portal_back_in_edit_mode">
                    <t t-set="backend_url" t-value="'/web#model=%s&amp;id=%s&amp;action=%s&amp;view_type=form' % (invoice._name, invoice.id, invoice.env.ref('account.action_move_out_invoice_type').id)"/>
                </t>
            </t>

            <div class="row mt16 o_portal_invoice_sidebar">
                <!-- Sidebar -->
                <t t-call="portal.portal_record_sidebar">
                    <t t-set="classes" t-value="'col-lg-auto d-print-none'"/>
                    <t t-set="title">
                        <h2 class="mb-0">
                            <b t-if="invoice.amount_residual > 0" t-field="invoice.amount_residual"/>
                            <b t-else="1" t-field="invoice.amount_total"/>
                        </h2>
                        <div class="small" t-if="invoice.payment_state not in ('paid', 'in_payment') and invoice.move_type == 'out_invoice'"><i class="fa fa-clock-o"/><span class="o_portal_sidebar_timeago ml4" t-att-datetime="invoice.invoice_date_due"/></div>
                    </t>

                    <t t-set="entries">
                        <ul class="list-group list-group-flush flex-wrap flex-row flex-lg-column">
                            <li class="list-group-item flex-grow-1">
                                <div class="o_download_pdf btn-toolbar flex-sm-nowrap">
                                    <div class="btn-group  flex-grow-1 mr-1 mb-1">
                                        <a class="btn btn-secondary btn-block o_download_btn" t-att-href="invoice.get_portal_url(report_type='pdf', download=True)" title="Download"><i class="fa fa-download"/> Download</a>
                                    </div>
                                    <div class="btn-group flex-grow-1 mb-1">
                                        <a class="btn btn-secondary btn-block o_print_btn o_portal_invoice_print" t-att-href="invoice.get_portal_url(report_type='pdf')" id="print_invoice_report" title="Print" target="_blank"><i class="fa fa-print"/> Print</a>
                                    </div>
                                </div>
                            </li>
                            <li t-if="invoice.invoice_user_id" class="list-group-item flex-grow-1">
                                <div class="small mb-1"><strong class="text-muted">
                                    <t t-if="invoice.move_type == 'out_invoice'">
                                        Salesperson
                                    </t>
                                    <t t-if="invoice.move_type == 'in_invoice'">
                                        Purchase Representative
                                    </t>
                                </strong></div>
                                <div class="row">
                                    <div class="col flex-grow-0 pr-2">
                                        <img t-if="invoice.invoice_user_id.image_1024" class="rounded-circle mt-1 o_portal_contact_img" t-att-src="image_data_uri(invoice.invoice_user_id.image_1024)" alt="Contact"/>
                                        <img t-else="" class="rounded-circle mt-1 o_portal_contact_img" src="/web/static/src/img/user_menu_avatar.png" alt="Contact"/>
                                    </div>
                                    <div class="col pl-0">
                                        <span t-field="invoice.invoice_user_id" t-options='{"widget": "contact", "fields": ["name", "phone"], "no_marker": True}'/>
                                        <a href="#discussion" class="small"><i class="fa fa-fw fa-comments"/><b>Send message</b></a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </t>
                </t>

                <!-- Page Content -->
                <div id="invoice_content" class="col-12 col-lg">
                    <t t-if="error or warning" t-call="account.portal_invoice_error"/>
                    <t t-if="success and (not error and not warning)" t-call="account.portal_invoice_success"/>

                    <div class="o_portal_html_view shadow p-3">
                        <div class="o_portal_html_loader text-center">
                            <i class="fa fa-circle-o-notch fa-spin fa-2x fa-fw text-black-50"></i>
                        </div>
                        <iframe id="invoice_html" class="mt8 mb8" width="100%" height="100%" frameborder="0" scrolling="no" t-att-src="invoice.get_portal_url(report_type='html')"/>
                    </div>
                    <!-- chatter -->
                    <div id="invoice_communication" class="mt-4">
                        <h2>History</h2>
                        <t t-call="portal.message_thread">
                            <t t-set="object" t-value="invoice"/>
                        </t>
                    </div>
                </div>
            </div>
        </xpath>
    </template>
    </data>


</odoo>
