<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!--Report Excel Extended -->
    <record model="ir.ui.view" id="action_inventory_turnover_extended_report_form">
        <field name="name">inventory.turnover.extended.form</field>
        <field name="model">inventory.turnover.extended</field>
        <field name="arch" type="xml">
            <form string="Excel Report">
                <group>
                    <group>
                        <field name="excel_file" readonly="1" filename="file_name"/>
                    </group>
                    <group>
                        <field name="file_name" invisible="1"/>
                    </group>
                </group>
                <footer>
                    <button string="Cancel" name="cancel" special="cancel" class="oe_highlight"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Report Excel Extened action -->
    <record id="action_inventory_turnover_report_extended" model="ir.actions.act_window">
        <field name="name">inventory.turnover.extended</field>
        <field name="res_model">inventory.turnover.extended</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    

    <record id="inventory_turnover_extended_report_tree" model="ir.ui.view">
            <field name="name">inventory.turnover.extended.tree</field>
            <field name="model">inventory.turnover.extended</field>
            <field name="arch" type="xml">
                <tree string="Warehouse Turnover Analysis Report" create="false">
                    <field name="company" />
                    <field name="warehouse" />
                    <field name="products" />
                    <field name="product_category" />
                    <field name="stock_opening" />
                    <field name="stock_closing" />
                    <field name="stock_average" />
                    <field name="sales" />
                    <field name="turnover" />
                </tree>
            </field>
        </record>

        <record id="inventory_turnover_extended_report_search" model="ir.ui.view">
            <field name="name">inventory.turnover.extended.search</field>
            <field name="model">inventory.turnover.extended</field>
            <field name="arch" type="xml">
                <search string="Warehouse Turnover Analysis Report">
                    
                    <field name="products" />
                    <field name="product_category" />
                    <field name="company" />
                    <field name="warehouse" />

                    <separator/>
                        <filter string="Product Category" context="{'group_by':'product_category'}" name="product_category_groupby"/>
                        <filter string="Company" context="{'group_by':'company'}" name="company_groupby"/>
                        <filter string="Product" context="{'group_by':'products'}" name="products_groupby"/>
                        <filter string="Warehouse" context="{'group_by':'warehouse'}" name="warehouse_groupby"/>
                    <separator/>

                </search>
            </field>
        </record>

        <record id="inventory_turnover_extended_report_graph" model="ir.ui.view">
            <field name="name">inventory.turnover.extended.report.graph</field>
            <field name="model">inventory.turnover.extended</field>
            <field name="arch" type="xml">
                <graph string="Warehouse Turnover Analysis Report" type="bar" stacked="False">
                    <field name="warehouse" type="col"/>
                    <field name="product_category" type="row"/>
                    <field name="turnover" type="measure"/>
                </graph>
            </field>
        </record>

        <!-- Report Wizard Form View -->
        <record id="inventory_turnover_wizard_form_view" model="ir.ui.view">
            <field name="name">inventory.turnover.report.wiz.form</field>
            <field name="model">inventory.turnover.report.wiz</field>
            <field name="arch" type="xml">
                <form string="Warehouse Turnover Analysis Report">
                        <sheet string="Warehouse Turnover Analysis Report">
                               
                                <group expand="0" string="Select Product And Category">
                                    <field name="category_ids" widget="many2many_tags" />
                                    <field name="product_ids" widget="many2many_tags" />
                                </group>
                                <group expand="0" string="Select Company And Warehouse">
                                    <field name="company_ids" widget="many2many_tags" />
                                    <field name="warehouse_ids" widget="many2many_tags" />
                                </group>
                                 <group expand="0" string="Select date">
                                    <field name="from_date" required="True" />
                                    <field name="to_date" required="True" />
                                </group>

                        </sheet>
                        <footer>
                            <button name="print_inventory_turnover_report" string="Excel" type="object"
                                    class="oe_highlight"/>
                            <button name="tree_graph_report_view" string="Data" type="object"
                                    class="oe_highlight"/>
                            <button name="tree_graph_report_view" string="Graph" type="object"
                                    class="oe_highlight" context="{'report_graph':True}"/>
                            <button string="Cancel" class="oe_link" special="cancel" />
                        </footer>

                    </form>
            </field>
        </record>

        <!--Report Wizard Action View -->
        <record id="action_inventory_turnover_report_action" model="ir.actions.act_window">
            <field name="name">Warehouse Turnover Analysis Report</field>
            <field name="res_model">inventory.turnover.report.wiz</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <menuitem id="bi_inventory_turnover_reports_report_menu" action="action_inventory_turnover_report_action"
                parent="stock.menu_warehouse_report" sequence="1" />


</odoo>
